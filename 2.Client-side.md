# Client-site Basic
---
>HTTP는 앞서 말했듯이, __Connectionless__ 하고 __Stateless__ 하다.  
이 때, 반복 인증을 피하기 위해 보편적으로 웹 서버가 쿠키와 세션을 이용한다.  
웹 브라우저는 __Stateful__ 한 상태를 유지하기 위해, 쿠키와 세션을 __모든 HTTP Request__ 에 함께 보낸다.  
이 때, __Client-Side Vulnerability__가 발생한다.  

### SOP(Same Origin Policy)
> JavaScript는 페이지 내의 요소들을 임의대로 관리할 수 있다.  
사용자의 요청 시, __HTTP request__ 에 Cookie를 서버가 함께 보내므로 외부 리소스를 이용하는 등, 이를 악용할 수 있다.  
이런 상황을 막기 위해 __SOP__ 를 이용하게 되었다.  

> 앞서 배웠듯이, URI의 __Origin__ 은, __HOST__ , __Scheme(Protocol)__ , __Port__ 로 구성된다.  
이 구성원들이 모두 동일해야만, _Same Origin_ 이라고 분류되어 접근과 요청이 가능해진다. 
하나라도 다를 경우는, _Cross Origin_ 으로 분류되어 접근과 요청이 불가능하다.

                                                 https://same-origin.com/
     
| URL | 결과 | 이유 |
|:---:|:---:|:---:|
|https://same-origin.com/index.html|Same origin|Path만 다르다.| 
|https://dreamhack.io/|Cross origin|Host가 다르다.|
|http://same-origin.com/|Cross origin|Scheme(Protocol)이 다르다.|
|http://same-origin.com:7777|Cross origin|Port가 다르다.|  

### CORS(Cross Origin Resource Sharing)
>위와 같이 SOP에 의해 다른 오리진의 리소스와 상호작용이 불가능한데, 꼭 해야만 하는 경우가 발생할 수 있다.  
이 때, 다른 오리진의 리소스와 상호작용할 수 있도록 만들어 진 것이 _CORS(Cross Origin Resource Sharing)_ 이다.
- postMessage : .postMessage는 메시지를 주고 받을 수 있는 핸들러이다. 이로 리소스 공유가 가능하다.
- JSNOP : 스크립트 태그를 이용해 JavaScript 코드를 호출하면, 해당 코드는 현재 오리진에서 실행된다. 이 점을 이용한다.  
          JavaScript의 함수인 __Callback Function__ 을 이용하여, 다른 오리진에 요청한 리소스에 대한 응답을 현재 오리진의 __Callback Function__ 에서 받는다.
- CORS Header : HTTP 헤더인 __OPTION__ 을 이용하여 다른 리소스에서 허용된 메소드를 찾아, 그 메소드로 리소스를 공유한다.
   ```javascript
   xhr = new XMLHttpRequest();
   xhr.open('POST', 'https://test.dreamhack.io/me');
   xhr.withCredentials = true;
   xhr.setRequestHeader('Content-Type', 'application/json');
   xhr.send("{'data':'hello world!'}");
   ```
   위 코드와 같이 다른 오리진에 요청을 보내면, OPTION 메소드를 통해 사용된 Header와 Method가 허용된 것인지 판단한다.  
   이와 같은 방식을 __CORS Preflight__ 라고 한다.
   
   
### Cross Site Scripting(XSS)
>본격적으로, 취약점 공격에 대해 알아보자.  
가장 먼저 __XSS(Cross Site Scripting)__ 은 서버의 __Response__ 에 공격자가 심어놓은 스크립트가 실행되어, 취약점이 발생하는 것.  
이를 통해 해당 서버 사용자의 쿠키를 탈취하거나, 페이지를 변조하는 등의 공격이 가능하다.
- Condition of XSS
  - 입력 데이터에 대한 검증 과정의 부재. ==> 악성 스크립트가 입력 되어도, 검증할 수 없어야 함.
  - 웹 브라우저 내 페이지에 입력 데이터 출력 시, 검증 과정의 부재. ==> 악성 스크립트가 성공적으로 렌더링 과정에 포함 되어야 함.
- Stored XSS
- Reflected XSS
- Mitiagtion(예방책)
  - Server-Side Mitigation
  - HTTP Only Flag
  - CSP(Content Security Policy)
  - X-XSS-Protection

### CSRF(Cross Site Request Forgery)
- CSRF(Cross Site Request Forgery)
- Mitigation
  - Custom Header
  - Unexcepted Parameter or Verifying
  - Same-Site Cookie
  
### Open Redirect
- Mitigation

### Click Jacking
- Mitigation
